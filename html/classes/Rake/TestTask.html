<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Class: Rake::TestTask</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />

    <script language="JavaScript" type="text/javascript">
    // <![CDATA[

        function toggleSource( id )
        {
          var elem
          var link

          if( document.getElementById )
          {
            elem = document.getElementById( id )
            link = document.getElementById( "l_" + id )
          }
          else if ( document.all )
          {
            elem = eval( "document.all." + id )
            link = eval( "document.all.l_" + id )
          }
          else
            return false;

          if( elem.style.display == "block" )
          {
            elem.style.display = "none"
            link.innerHTML = "show source"
          }
          else
          {
            elem.style.display = "block"
            link.innerHTML = "hide source"
          }
        }

        function openCode( url )
        {
          window.open( url, "SOURCE_CODE", "width=400,height=400,scrollbars=yes" )
        }
      // ]]>
    </script>
  </head>

  <body>
  <table width="100%" border='0' cellpadding='0' cellspacing='0' class='banner'><tr>
  <td class="file-title"><span class="file-title-prefix">Class</span><br />Rake::TestTask</td>
  <td align="right">
    <table cellspacing=0 cellpadding=2>
      <tr valign="top">
        <td>In:</td>
        <td>
<a href="../../files/lib/rake/testtask_rb.html">lib/rake/testtask.rb</a>
        </td>
      </tr>
    <tr>
      <td>Parent:</td>
      <td>
        <a href="TaskLib.html">
TaskLib
         </a>
     </td>
   </tr>
         </table>
        </td>
        </tr>
      </table>
 <!-- banner header -->

  <div id="bodyContent">
      <div id="content">

  <div class="description"><p>
Create a task that runs a set of tests.
</p>
<p>
Example:
</p>
<pre>
  Rake::TestTask.new do |t|
    t.libs &lt;&lt; &quot;test&quot;
    t.test_files = FileList['test/test*.rb']
    t.verbose = true
  end
</pre>
<p>
If rake is invoked with a &quot;TEST=filename&quot; command line option,
then the list of test files will be overridden to include only the filename
specified on the command line. This provides an easy way to run just one
test.
</p>
<p>
If rake is invoked with a &quot;TESTOPTS=options&quot; command line option,
then the given options are passed to the test process after a
&#8217;&#8212;&#8217;. This allows <a
href="../Test/Unit.html">Test::Unit</a> options to be passed to the test
suite.
</p>
<p>
Examples:
</p>
<pre>
  rake test                           # run tests normally
  rake test TEST=just_one_file.rb     # run just one test file.
  rake test TESTOPTS=&quot;-v&quot;             # run in verbose mode
  rake test TESTOPTS=&quot;--runner=fox&quot;   # use the fox test runner
</pre>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="#M000068">define</a></li>
  <li><a href="#M000067">new</a></li>
  <li><a href="#M000066">test_files=</a></li>
  </ul>





  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>libs</td>
    <td class='attr-desc'>
List of directories to added to $LOAD_PATH before running the tests.
(default is &#8216;lib&#8217;)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>loader</td>
    <td class='attr-desc'>
Style of test loader to use. Options are:

<ul>
<li>:rake &#8212; <a href="../Rake.html">Rake</a> provided test loading script
(default).

</li>
<li>:testrb &#8212; Ruby provided test loading script.

</li>
<li>:direct &#8212; Load tests using command line loader.

</li>
</ul>
</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>name</td>
    <td class='attr-desc'>
Name of test task. (default is :test)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>options</td>
    <td class='attr-desc'>
<a href="../Test.html">Test</a> options passed to the test suite. An
explicit TESTOPTS=opts on the command line will override this. (default is
NONE)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>pattern</td>
    <td class='attr-desc'>
Glob pattern to match test files. (default is &#8216;test/test*.rb&#8217;)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>ruby_opts</td>
    <td class='attr-desc'>
Array of commandline options to pass to ruby when running test loader.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>verbose</td>
    <td class='attr-desc'>
True if verbose test output desired. (default is false)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>warning</td>
    <td class='attr-desc'>
Request that the tests be run with the warning flag set. E.g. warning=true
implies &quot;ruby -w&quot; used to run the tests.

</td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div class="method">
  <div class="title">
    <a name="M000067"></a><b>new</b>(name=:test) {|self if block_given?| ...}
  </div>
  <div class="description">
  <p>
Create a testing task.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000067_source')" id="l_M000067_source">show source</a> ]</p>
  <div id="M000067_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/rake/testtask.rb, line 81</span>
81:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">name</span>=<span class="ruby-identifier">:test</span>)
82:       <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">name</span>
83:       <span class="ruby-ivar">@libs</span> = [<span class="ruby-value str">&quot;lib&quot;</span>]
84:       <span class="ruby-ivar">@pattern</span> = <span class="ruby-keyword kw">nil</span>
85:       <span class="ruby-ivar">@options</span> = <span class="ruby-keyword kw">nil</span>
86:       <span class="ruby-ivar">@test_files</span> = <span class="ruby-keyword kw">nil</span>
87:       <span class="ruby-ivar">@verbose</span> = <span class="ruby-keyword kw">false</span>
88:       <span class="ruby-ivar">@warning</span> = <span class="ruby-keyword kw">false</span>
89:       <span class="ruby-ivar">@loader</span> = <span class="ruby-identifier">:rake</span>
90:       <span class="ruby-ivar">@ruby_opts</span> = []
91:       <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
92:       <span class="ruby-ivar">@pattern</span> = <span class="ruby-value str">'test/test*.rb'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@pattern</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@test_files</span>.<span class="ruby-identifier">nil?</span>
93:       <span class="ruby-identifier">define</span>
94:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div class="method">
  <div class="title">
    <a name="M000068"></a><b>define</b>()
  </div>
  <div class="description">
  <p>
Create the tasks defined by this task lib.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000068_source')" id="l_M000068_source">show source</a> ]</p>
  <div id="M000068_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rake/testtask.rb, line 97</span>
 97:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">define</span>
 98:       <span class="ruby-identifier">lib_path</span> = <span class="ruby-ivar">@libs</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
 99:       <span class="ruby-identifier">desc</span> <span class="ruby-value str">&quot;Run tests&quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-ivar">@name</span><span class="ruby-operator">==</span><span class="ruby-identifier">:test</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot; for #{@name}&quot;</span>)
100:       <span class="ruby-identifier">task</span> <span class="ruby-ivar">@name</span> <span class="ruby-keyword kw">do</span>
101:         <span class="ruby-identifier">run_code</span> = <span class="ruby-value str">''</span>
102:         <span class="ruby-constant">RakeFileUtils</span>.<span class="ruby-identifier">verbose</span>(<span class="ruby-ivar">@verbose</span>) <span class="ruby-keyword kw">do</span>
103:           <span class="ruby-identifier">run_code</span> =
104:             <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@loader</span>
105:             <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:direct</span>
106:               <span class="ruby-value str">&quot;-e 'ARGV.each{|f| load f}'&quot;</span>
107:             <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:testrb</span>
108:               <span class="ruby-node">&quot;-S testrb #{fix}&quot;</span>
109:             <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:rake</span>
110:               <span class="ruby-identifier">rake_loader</span>
111:             <span class="ruby-keyword kw">end</span>
112:           <span class="ruby-ivar">@ruby_opts</span>.<span class="ruby-identifier">unshift</span>( <span class="ruby-node">&quot;-I#{lib_path}&quot;</span> )
113:           <span class="ruby-ivar">@ruby_opts</span>.<span class="ruby-identifier">unshift</span>( <span class="ruby-value str">&quot;-w&quot;</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@warning</span>
114:           <span class="ruby-identifier">ruby</span> <span class="ruby-ivar">@ruby_opts</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>) <span class="ruby-operator">+</span>
115:             <span class="ruby-node">&quot; \&quot;#{run_code}\&quot; &quot;</span> <span class="ruby-operator">+</span>
116:             <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">fn</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\&quot;#{fn}\&quot;&quot;</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>) <span class="ruby-operator">+</span>
117:             <span class="ruby-node">&quot; #{option_list}&quot;</span>
118:         <span class="ruby-keyword kw">end</span>
119:       <span class="ruby-keyword kw">end</span>
120:       <span class="ruby-keyword kw">self</span>
121:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000066"></a><b>test_files=</b>(list)
  </div>
  <div class="description">
  <p>
Explicitly <a href="TestTask.html#M000068">define</a> the list of test
files to be included in a test. <tt>list</tt> is expected to be an array of
file names (a <a href="FileList.html">FileList</a> is acceptable). If both
<tt>pattern</tt> and <tt>test_files</tt> are used, then the list of test
files is the union of the two.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000066_source')" id="l_M000066_source">show source</a> ]</p>
  <div id="M000066_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/rake/testtask.rb, line 76</span>
76:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_files=</span>(<span class="ruby-identifier">list</span>)
77:       <span class="ruby-ivar">@test_files</span> = <span class="ruby-identifier">list</span>
78:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>

    </body>
</html>